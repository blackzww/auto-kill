-- Script para King Legacy - Auto Kill com Teclas 1-4
-- Coloque este script em um LocalScript

local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local VirtualInputManager = game:GetService("VirtualInputManager")

local player = Players.LocalPlayer
local mouse = player:GetMouse()

-- Variáveis de controle
local autoKillEnabled = false
local targetPlayer = nil
local connection = nil
local autoClickEnabled = true

-- Criar a GUI
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "KingLegacyAutoKill"
screenGui.Parent = player:WaitForChild("PlayerGui")

local mainFrame = Instance.new("Frame")
mainFrame.Size = UDim2.new(0, 280, 0, 220)
mainFrame.Position = UDim2.new(0, 10, 0, 10)
mainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
mainFrame.BorderSizePixel = 0
mainFrame.Active = true
mainFrame.Draggable = true
mainFrame.Parent = screenGui

local UICorner = Instance.new("UICorner")
UICorner.CornerRadius = UDim.new(0, 8)
UICorner.Parent = mainFrame

local title = Instance.new("TextLabel")
title.Size = UDim2.new(1, 0, 0, 40)
title.Position = UDim2.new(0, 0, 0, 0)
title.BackgroundColor3 = Color3.fromRGB(20, 20, 30)
title.Text = "KING LEGACY AUTO KILL"
title.TextColor3 = Color3.fromRGB(255, 215, 0)
title.TextSize = 16
title.Font = Enum.Font.GothamBold
title.Parent = mainFrame

local UICorner2 = Instance.new("UICorner")
UICorner2.CornerRadius = UDim.new(0, 8)
UICorner2.Parent = title

local toggleButton = Instance.new("TextButton")
toggleButton.Size = UDim2.new(0.8, 0, 0, 45)
toggleButton.Position = UDim2.new(0.1, 0, 0.25, 0)
toggleButton.BackgroundColor3 = Color3.fromRGB(200, 60, 60)
toggleButton.Text = "ATIVAR AUTO KILL"
toggleButton.TextColor3 = Color3.fromRGB(255, 255, 255)
toggleButton.TextSize = 14
toggleButton.Font = Enum.Font.GothamBold
toggleButton.Parent = mainFrame

local UICorner3 = Instance.new("UICorner")
UICorner3.CornerRadius = UDim.new(0, 6)
UICorner3.Parent = toggleButton

local autoClickToggle = Instance.new("TextButton")
autoClickToggle.Size = UDim2.new(0.35, 0, 0, 30)
autoClickToggle.Position = UDim2.new(0.1, 0, 0.55, 0)
autoClickToggle.BackgroundColor3 = Color3.fromRGB(60, 200, 60)
autoClickToggle.Text = "AUTO CLICK: ON"
autoClickToggle.TextColor3 = Color3.fromRGB(255, 255, 255)
autoClickToggle.TextSize = 12
autoClickToggle.Font = Enum.Font.Gotham
autoClickToggle.Parent = mainFrame

local UICorner4 = Instance.new("UICorner")
UICorner4.CornerRadius = UDim.new(0, 6)
UICorner4.Parent = autoClickToggle

local statusLabel = Instance.new("TextLabel")
statusLabel.Size = UDim2.new(0.8, 0, 0, 25)
statusLabel.Position = UDim2.new(0.1, 0, 0.7, 0)
statusLabel.BackgroundTransparency = 1
statusLabel.Text = "Status: Desativado"
statusLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
statusLabel.TextSize = 14
statusLabel.Parent = mainFrame

local targetLabel = Instance.new("TextLabel")
targetLabel.Size = UDim2.new(0.8, 0, 0, 25)
targetLabel.Position = UDim2.new(0.1, 0, 0.85, 0)
targetLabel.BackgroundTransparency = 1
targetLabel.Text = "Alvo: Nenhum"
targetLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
targetLabel.TextSize = 12
targetLabel.Parent = mainFrame

-- Função para encontrar o jogador mais próximo
function findNearestPlayer()
    local nearestPlayer = nil
    local shortestDistance = math.huge
    
    if not player.Character or not player.Character:FindFirstChild("HumanoidRootPart") then
        return nil, math.huge
    end
    
    for _, otherPlayer in pairs(Players:GetPlayers()) do
        if otherPlayer ~= player and otherPlayer.Character then
            local humanoidRootPart = otherPlayer.Character:FindFirstChild("HumanoidRootPart")
            local humanoid = otherPlayer.Character:FindFirstChildOfClass("Humanoid")
            
            if humanoidRootPart and humanoid and humanoid.Health > 0 then
                local distance = (player.Character.HumanoidRootPart.Position - humanoidRootPart.Position).Magnitude
                if distance < shortestDistance and distance < 100 then
                    shortestDistance = distance
                    nearestPlayer = otherPlayer
                end
            end
        end
    end
    
    return nearestPlayer, shortestDistance
end

-- Função para movimentação usando teclas
function moveToTarget(targetPosition)
    if not player.Character or not player.Character:FindFirstChild("HumanoidRootPart") then
        return
    end
    
    local playerPos = player.Character.HumanoidRootPart.Position
    local distance = (targetPosition - playerPos).Magnitude
    
    -- Se estiver muito longe, usa teclas para se aproximar
    if distance > 15 then
        -- Calcula a direção para o alvo
        local direction = (targetPosition - playerPos).Unit
        
        -- Move para frente (W) na direção do alvo
        VirtualInputManager:SendKeyEvent(true, Enum.KeyCode.W, false, game)
        
        -- Pequeno delay para movimento
        wait(0.5)
        VirtualInputManager:SendKeyEvent(false, Enum.KeyCode.W, false, game)
    end
end

-- Função de auto click rápido
function rapidAutoClick()
    if not autoClickEnabled then return end
    
    for i = 1, 3 do -- 3 cliques rápidos
        VirtualInputManager:SendMouseButtonEvent(mouse.X, mouse.Y, 0, true, game, 0)
        wait(0.05)
        VirtualInputManager:SendMouseButtonEvent(mouse.X, mouse.Y, 0, false, game, 0)
        wait(0.05)
    end
end

-- Função para executar sequência de ataques (Z, X, C, V, E, B)
function executeAttackSequence()
    local attackKeys = {
        Enum.KeyCode.Z,
        Enum.KeyCode.X, 
        Enum.KeyCode.C,
        Enum.KeyCode.V,
        Enum.KeyCode.E,
        Enum.KeyCode.B
    }
    
    for _, key in ipairs(attackKeys) do
        if not autoKillEnabled then break end
        
        -- Pressiona a tecla de ataque
        VirtualInputManager:SendKeyEvent(true, key, false, game)
        wait(0.15)
        VirtualInputManager:SendKeyEvent(false, key, false, game)
        
        -- Auto click após cada ataque
        rapidAutoClick()
        wait(0.1)
    end
end

-- Função principal do auto kill
function autoKillLoop()
    if not autoKillEnabled or not player.Character or not player.Character:FindFirstChild("HumanoidRootPart") then
        return
    end
    
    -- Encontra o jogador mais próximo
    local nearest, distance = findNearestPlayer()
    
    if nearest and nearest.Character and distance < 80 then
        targetPlayer = nearest
        targetLabel.Text = "Alvo: " .. nearest.Name
        
        local targetRoot = nearest.Character.HumanoidRootPart
        
        -- Move-se para perto do alvo
        moveToTarget(targetRoot.Position)
        
        -- Sequência de ataques com teclas 1-4
        for toolNumber = 1, 4 do
            if not autoKillEnabled then break end
            
            -- Pressiona a tecla do número (1, 2, 3, 4)
            local numberKey = Enum.KeyCode[tonumber(toolNumber)]
            VirtualInputManager:SendKeyEvent(true, numberKey, false, game)
            wait(0.2)
            VirtualInputManager:SendKeyEvent(false, numberKey, false, game)
            wait(0.3)
            
            -- Executa a sequência de ataques
            executeAttackSequence()
            wait(0.2)
        end
        
    else
        targetPlayer = nil
        targetLabel.Text = "Alvo: Nenhum"
    end
end

-- Controle do toggle do auto kill
toggleButton.MouseButton1Click:Connect(function()
    autoKillEnabled = not autoKillEnabled
    
    if autoKillEnabled then
        toggleButton.BackgroundColor3 = Color3.fromRGB(60, 200, 60)
        toggleButton.Text = "DESATIVAR AUTO KILL"
        statusLabel.Text = "Status: Ativado"
        statusLabel.TextColor3 = Color3.fromRGB(0, 255, 0)
        
        -- Inicia o loop
        connection = RunService.Heartbeat:Connect(function()
            autoKillLoop()
        end)
    else
        toggleButton.BackgroundColor3 = Color3.fromRGB(200, 60, 60)
        toggleButton.Text = "ATIVAR AUTO KILL"
        statusLabel.Text = "Status: Desativado"
        statusLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
        
        -- Para o loop
        if connection then
            connection:Disconnect()
            connection = nil
        end
        targetPlayer = nil
        targetLabel.Text = "Alvo: Nenhum"
    end
end)

-- Controle do auto click
autoClickToggle.MouseButton1Click:Connect(function()
    autoClickEnabled = not autoClickEnabled
    
    if autoClickEnabled then
        autoClickToggle.BackgroundColor3 = Color3.fromRGB(60, 200, 60)
        autoClickToggle.Text = "AUTO CLICK: ON"
    else
        autoClickToggle.BackgroundColor3 = Color3.fromRGB(200, 60, 60)
        autoClickToggle.Text = "AUTO CLICK: OFF"
    end
end)

-- Função para teletransporte suave até o alvo
function smoothTeleportToTarget()
    if not targetPlayer or not targetPlayer.Character then return end
    
    local targetRoot = targetPlayer.Character.HumanoidRootPart
    local playerRoot = player.Character.HumanoidRootPart
    
    -- Posição na frente do alvo (5 unidades de distância)
    local direction = (targetRoot.Position - playerRoot.Position).Unit
    local targetPosition = targetRoot.Position - (direction * 5)
    
    -- Teletransporte suave
    playerRoot.CFrame = CFrame.new(targetPosition, targetRoot.Position)
end

-- Atalho de tecla para teletransporte rápido (Shift + T)
UserInputService.InputBegan:Connect(function(input, gameProcessed)
    if gameProcessed then return end
    
    if input.KeyCode == Enum.KeyCode.T and UserInputService:IsKeyDown(Enum.KeyCode.LeftShift) then
        if targetPlayer and targetPlayer.Character then
            smoothTeleportToTarget()
        end
    end
end)

-- Limpeza quando o script for destruído
screenGui.Destroying:Connect(function()
    if connection then
        connection:Disconnect()
    end
end)

-- Mensagem de inicialização
print("King Legacy Auto Kill carregado!")
print("Use Shift + T para teletransporte rápido até o alvo")
